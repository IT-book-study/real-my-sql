# Introduction
- 디스크의 데이터 파일의 크기 ↑
  - 쿼리 처리를 위해 더 많은 데이터 페이지를 InnoDB 버퍼 풀로 로딩
  - 새로운 페이지가 버퍼 풀로 적재 => 더티 페이지가 더 자주 디스크로 기록 => 디스크 I/O ↑
  - 백업 시간 ↑
  - 복구 시간 ↑
- 이를 해결하기 위해 **데이터 압축 기능**제공
  - MySQL 서버는 테이블 압축과 페이지 압축 두 가지 압축 방식을 제공  

# 6.1 페이지 압축
- 디스크에 저장하는 시점에 데이터 페이지를 압축하여 저장 
  - 읽어올 때 압축이 해제
- 버퍼 풀에 데이터 페이지 적재 -> InnoDB 스토리지 엔진은 **압축이 해제된 상태로만 데이터 페이지를 관리**
  - MySQL 서버의 내부 코드에서는 압축 여부와 관계 없이 **투명하게 작동한다고 해서 Transparent Page Compression**이라고도 함    
- 데이터 페이지는 16KB -> 압축한 결과 용량이 얼마나 될 지 예측 불가 
  - 적어도 하나의 테이블은 동일한 크기의 페이지(블록)로 통일되어야 함 (한 테이블 내 페이지 크기는 같아야 된다는 의미)

### 동일한 크기의 페이지를 제공하기 위한 압축 방법 
- OS별로 특정 파일 시스템에서만 지원되는 **펀치 홀(Punch hole)** 기능 사용 
  - 펀치홀이란?
    - 파일 시스템에서 빈 공간을 표현하는 방법
- OS 파일 시스템의 블록 사이즈가 512byte인 경우 페이지 압축 작동 방식 
  1. 16KB 페이지를 압축 (결과가 7KB라고 가정)
  2. MySQL 서버가 디스크에 압축된 결과인 7KB를 기록 
     - `압축된 데이터 7KB`를 기록하고, `빈 공간 9KB`를 기록
  3. 7KB 이후 공간인 9KB에 대해 **펀치 홀(Punch hole)** 생성 
  4. 파일 시스템은 7KB만 남기고, 나머지 9KB는 OS로 반납 

